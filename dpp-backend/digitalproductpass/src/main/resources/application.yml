#################################################################################
# Tractus-X - Digital Product Passport Application
#
# Copyright (c) 2022, 2024 BASF SE, BMW AG, Henkel AG & Co. KGaA
# Copyright (c) 2022, 2024 Contributors to the Eclipse Foundation
#
# See the NOTICE file(s) distributed with this work for additional
# information regarding copyright ownership.
#
# This program and the accompanying materials are made available under the
# terms of the Apache License, Version 2.0 which is available at
# https://www.apache.org/licenses/LICENSE-2.0.
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
# either express or implied. See the
# License for the specific language govern in permissions and limitations
# under the License.
#
# SPDX-License-Identifier: Apache-2.0
#################################################################################


spring:
  name: 'Catena-X Digital Product Passport Consumer Backend'
  main:
    allow-bean-definition-overriding: true
  devtools:
    add-properties: false
  jackson:
    serialization:
      indent_output: true

logging:
  level:
    root: INFO
    utils: INFO

configuration:
  maxRetries: 5

  bpdm:
    enabled: true
    endpoint: "https://partners-pool.int.demo.catena-x.net"
    companyInfo:
      apiPath: "api/catena/legal-entities"
      bpnKey: "bpn"
      name:
        path: "names"
        technicalKeys: # -- or operator active (just one will be retrieved)
          - "LOCAL"
    site:
      apiPath: "/api/catena/sites/main-addresses/search"
      bpnKey: "site"
      countryPath: "country.name"
      postalCode:
        path: "mainAddress.postalCodes"
        technicalKeys: # -- or operator active (just one will be retrieved)
          - "OTHER"
      city:
        path: "mainAddress.localities"
        technicalKeys: # -- or operator active (just one will be retrieved)
          - "CITY"
      street:
        path: "mainAddress.thoroughfares"
        technicalKeys: # -- or operator active (just one will be retrieved)
          - "STREET"
    legalEntity:
      apiPath: "/api/catena/legal-entities/legal-addresses/search"
      bpnKey: "legalEntity"
      countryPath: "legalAddress.country.name"
      postalCode:
        path: "legalAddress.postalCodes"
        technicalKeys: # -- or operator active (just one will be retrieved)
          - "REGULAR"
      city:
        path: "legalAddress.localities"
        technicalKeys: # -- or operator active (just one will be retrieved)
          - "CITY"
      street:
        path: "legalAddress.thoroughfares"
        technicalKeys: # -- or operator active (just one will be retrieved)
          - "STREET"
    address:
      apiPath: "api/catena/addresses"
      bpnKey: "address.bpn"
      countryPath: "address.country.name"
      postalCode:
        path: "address.postalCodes"
        technicalKeys: # -- or operator active (just one will be retrieved)
          - "REGULAR"
      city:
        path: "address.localities"
        technicalKeys: # -- or operator active (just one will be retrieved)
          - "CITY"
      street:
        path: "address.thoroughfares"
        technicalKeys: # -- or operator active (just one will be retrieved)
          - "STREET"

  keycloak:
    realm: CX-Central
    resource: Cl13-CX-Battery
    tokenUri: 'https://centralidp.int.demo.catena-x.net/auth/realms/CX-Central/protocol/openid-connect/token'
    userInfoUri: 'https://centralidp.int.demo.catena-x.net/auth/realms/CX-Central/protocol/openid-connect/userinfo'

  edc:
    endpoint: 'https://materialpass.int.demo.catena-x.net/consumer'
    readiness: '/api/check/readiness'
    management: '/management/v2'
    catalog: '/catalog/request'
    negotiation: '/contractnegotiations'
    transfer: '/transferprocesses'
    receiverEndpoint: 'https://dpp.int.demo.catena-x.net/endpoint'
    delay:  100 # -- Negotiation status Delay in milliseconds in between async requests [<= 500]
    transferType: "application/octet-stream"
    timeout:
      exchange: 10

  security:
    authorization:
      bpnAuth: false
      roleAuth: false
    startUpChecks:
      bpnCheck: false
      edcCheck: false

  irs:
    enabled: true
    endpoint: "https://materialpass-irs.int.demo.catena-x.net"
    paths:
      job: "/irs/jobs"
    tree:
      fileName: "treeDataModel"
      indent: true
    callbackUrl: "https://materialpass.int.demo.catena-x.net/api/irs"

  dtr:
    assetPropType: 'asset:prop:type'
    assetType: 'data.core.digitalTwinRegistry'
    endpointInterface: 'SUBMODEL-3.0'
    dspEndpointKey: 'dspEndpoint'
    semanticIdTypeKey: 'Submodel'
    decentralApis:
      search: "/lookup/shells"
      digitalTwin: "/shell-descriptors"
      subModel: "/submodel-descriptors"
    timeouts:
      search: 10
      negotiation: 10
      dtrRequestProcess: 40
      transfer: 10
      digitalTwin: 20
    temporaryStorage:
      enabled: true
      lifetime: 12 # -- Hours

  discovery:
    endpoint: "https://semantics.int.demo.catena-x.net/discoveryfinder/api/v1.0/administration/connectors/discovery/search"
    bpn:
      key: "manufacturerPartId"
      searchPath: "/api/v1.0/administration/connectors/bpnDiscovery/search"
      timeout: 1500
    edc:
      key: "bpn"
      timeout: 1500


  process:
    store: true
    dir: 'process'
    indent: true
    signKey: 'c55e3f35200f6afedbce37cefdaf40eadd15c92814edfdbc4d6ab0eacdcdd56dbcd5a2a34ca4b675084d33f9f479d7d79347795148aaf4443e1b47ab96b27e72'

  passport:
    searchIdSchema: "CX:<manufacturerPartId>:<partInstanceId>"
    dataTransfer:
      encrypt: true
      indent: true
      dir: "data/transfer"
    aspects:
      - "urn:bamm:io.catenax.generic.digital_product_passport:1.0.0#DigitalProductPassport"
      - "urn:bamm:io.catenax.battery.battery_pass:3.0.1#BatteryPass"

  vault:
    type: 'local'
    file: 'vault.token.yml'
    pathSep: "."
    prettyPrint: true
    indent: 2
    defaultValue: '<Add secret value here>'
    attributes:
      - "appId"
      - "client.id"
      - "client.secret"
      - "edc.apiKey"
      - "edc.participantId"

server:
  error:
    include-message: ALWAYS
    include-binding-errors: ALWAYS
    include-stacktrace: ON_PARAM
    include-exception: false
  port: 8888
  tomcat:
    max-connections: 10000
